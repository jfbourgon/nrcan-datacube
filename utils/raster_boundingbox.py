#!/usr/bin/env python

import argparse

import json
import rasterio
import shapely
from shapely.geometry import shape, box
from shapely.ops import transform
import pyproj

def main():
    parser = argparse.ArgumentParser()
    parser.add_argument('--format', default='wkt', help='output format')
    parser.add_argument('--latlong', default=False, action='store_true', help='reproject to Lat/Long coordinates (WGS84)')
    parser.add_argument('input', metavar='input', help='path to dataset')
    args = parser.parse_args()
    
    input = args.input
    format = args.format

    # open the input dataset in read mode
    ds = rasterio.open(input)

    # convert bounds to Polygon
    bounds = ds.bounds
    geom = box(bounds[0], bounds[1], bounds[2], bounds[3])
    
    if (args.latlong):
        projection = pyproj.Transformer.from_crs(ds.crs, pyproj.CRS('EPSG:4326'), always_xy=True).transform
        projected = transform(projection, geom) 
        geom = projected
    
    if format.lower() == 'geojson':
        geojson = shapely.geometry.mapping(geom)
        geom = json.dumps(geojson)
        
    print(geom)

if __name__ == "__main__":
    main()










































































































































































































































































































































































